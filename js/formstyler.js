!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){function b(b,c){this.element=b,this.options=a.extend({},e,c),this.init()}function c(b){if(!a(b.target).parents().hasClass("jq-selectbox")&&"OPTION"!=b.target.nodeName&&a("div.jq-selectbox.opened").length){b=a("div.jq-selectbox.opened");var c=a("div.jq-selectbox__search input",b),e=a("div.jq-selectbox__dropdown",b);b.find("select").data("_"+d).options.onSelectClosed.call(b),c.length&&c.val("").keyup(),e.hide().find("li.sel").addClass("selected"),b.removeClass("focused opened dropup dropdown")}}var d="styler",e={wrapper:"form",idSuffix:"-styler",filePlaceholder:"Выберите файл",fileBrowse:"Обзор...",fileNumber:"Выбрано файлов: %s",selectPlaceholder:"Выберите...",selectSearch:!1,selectSearchLimit:10,selectSearchNotFound:"Совпадений не найдено",selectSearchPlaceholder:"Поиск...",selectVisibleOptions:0,singleSelectzIndex:"100",selectSmartPositioning:!0,onSelectOpened:function(){},onSelectClosed:function(){},onFormStyled:function(){}};b.prototype={init:function(){function b(){var a="",b="",c="",f="";void 0!==d.attr("id")&&""!==d.attr("id")&&(a=' id="'+d.attr("id")+e.idSuffix+'"'),void 0!==d.attr("title")&&""!==d.attr("title")&&(b=' title="'+d.attr("title")+'"'),void 0!==d.attr("class")&&""!==d.attr("class")&&(c=" "+d.attr("class"));var h,g=d.data();for(h in g)""!==g[h]&&"_styler"!==h&&(f+=" data-"+h+'="'+g[h]+'"');this.id=a+f,this.title=b,this.classes=c}var d=a(this.element),e=this.options,f=!(!navigator.userAgent.match(/(iPad|iPhone|iPod)/i)||navigator.userAgent.match(/(Windows\sPhone)/i)),g=!(!navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/(Windows\sPhone)/i));if(d.is(":checkbox")){var h=function(){var c=new b,e=a("<div"+c.id+' class="jq-checkbox'+c.classes+'"'+c.title+'><div class="jq-checkbox__div"></div></div>');d.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(e).prependTo(e),e.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative",overflow:"hidden"}),d.is(":checked")&&e.addClass("checked"),d.is(":disabled")&&e.addClass("disabled"),e.click(function(a){a.preventDefault(),e.is(".disabled")||(d.is(":checked")?(d.prop("checked",!1),e.removeClass("checked")):(d.prop("checked",!0),e.addClass("checked")),d.focus().change())}),d.closest("label").add('label[for="'+d.attr("id")+'"]').on("click.styler",function(b){a(b.target).is("a")||a(b.target).closest(e).length||(e.triggerHandler("click"),b.preventDefault())}),d.on("change.styler",function(){d.is(":checked")?e.addClass("checked"):e.removeClass("checked")}).on("keydown.styler",function(a){32==a.which&&e.click()}).on("focus.styler",function(){e.is(".disabled")||e.addClass("focused")}).on("blur.styler",function(){e.removeClass("focused")})};h(),d.on("refresh",function(){d.closest("label").add('label[for="'+d.attr("id")+'"]').off(".styler"),d.off(".styler").parent().before(d).remove(),h()})}else if(d.is(":radio")){var i=function(){var c=new b,f=a("<div"+c.id+' class="jq-radio'+c.classes+'"'+c.title+'><div class="jq-radio__div"></div></div>');d.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(f).prependTo(f),f.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative"}),d.is(":checked")&&f.addClass("checked"),d.is(":disabled")&&f.addClass("disabled"),f.click(function(a){a.preventDefault(),f.is(".disabled")||(f.closest(e.wrapper).find('input[name="'+d.attr("name")+'"]').prop("checked",!1).parent().removeClass("checked"),d.prop("checked",!0).parent().addClass("checked"),d.focus().change())}),d.closest("label").add('label[for="'+d.attr("id")+'"]').on("click.styler",function(b){a(b.target).is("a")||a(b.target).closest(f).length||(f.triggerHandler("click"),b.preventDefault())}),d.on("change.styler",function(){d.parent().addClass("checked")}).on("focus.styler",function(){f.is(".disabled")||f.addClass("focused")}).on("blur.styler",function(){f.removeClass("focused")})};i(),d.on("refresh",function(){d.closest("label").add('label[for="'+d.attr("id")+'"]').off(".styler"),d.off(".styler").parent().before(d).remove(),i()})}else if(d.is(":file")){d.css({position:"absolute",top:0,right:0,width:"100%",height:"100%",opacity:0,margin:0,padding:0});var j=function(){var c=new b,f=d.data("placeholder");void 0===f&&(f=e.filePlaceholder);var g=d.data("browse");void 0!==g&&""!==g||(g=e.fileBrowse);var h=a("<div"+c.id+' class="jq-file'+c.classes+'"'+c.title+' style="display: inline-block; position: relative; overflow: hidden"></div>'),i=a('<div class="jq-file__name">'+f+"</div>").appendTo(h);a('<div class="jq-file__browse">'+g+"</div>").appendTo(h),d.after(h).appendTo(h),d.is(":disabled")&&h.addClass("disabled"),d.on("change.styler",function(){var a=d.val();if(d.is("[multiple]")){var a="",b=d[0].files.length;0<b&&(a=d.data("number"),void 0===a&&(a=e.fileNumber),a=a.replace("%s",b))}i.text(a.replace(/.+[\\\/]/,"")),""===a?(i.text(f),h.removeClass("changed")):h.addClass("changed")}).on("focus.styler",function(){h.addClass("focused")}).on("blur.styler",function(){h.removeClass("focused")}).on("click.styler",function(){h.removeClass("focused")})};j(),d.on("refresh",function(){d.off(".styler").parent().before(d).remove(),j()})}else if(d.is('input[type="number"]')){var k=function(){var b=a('<div class="jq-number"><div class="jq-number__spin minus"></div><div class="jq-number__spin plus"></div></div>');d.after(b).prependTo(b).wrap('<div class="jq-number__field"></div>'),d.is(":disabled")&&b.addClass("disabled");var c,e,f,g=null,h=null;void 0!==d.attr("min")&&(c=d.attr("min")),void 0!==d.attr("max")&&(e=d.attr("max")),f=void 0!==d.attr("step")&&a.isNumeric(d.attr("step"))?Number(d.attr("step")):Number(1);var i=function(b){var h,g=d.val();a.isNumeric(g)||(g=0,d.val("0")),b.is(".minus")?(h=parseInt(g,10)-f,0<f&&(h=Math.ceil(h/f)*f)):b.is(".plus")&&(h=parseInt(g,10)+f,0<f&&(h=Math.floor(h/f)*f)),a.isNumeric(c)&&a.isNumeric(e)?h>=c&&h<=e&&d.val(h):a.isNumeric(c)&&!a.isNumeric(e)?h>=c&&d.val(h):!a.isNumeric(c)&&a.isNumeric(e)?h<=e&&d.val(h):d.val(h)};b.is(".disabled")||(b.on("mousedown","div.jq-number__spin",function(){var b=a(this);i(b),g=setTimeout(function(){h=setInterval(function(){i(b)},40)},350)}).on("mouseup mouseout","div.jq-number__spin",function(){clearTimeout(g),clearInterval(h)}),d.on("focus.styler",function(){b.addClass("focused")}).on("blur.styler",function(){b.removeClass("focused")}))};k(),d.on("refresh",function(){d.off(".styler").closest(".jq-number").before(d).remove(),k()})}else if(d.is("select")){var l=function(){function h(b){b.off("mousewheel DOMMouseScroll").on("mousewheel DOMMouseScroll",function(b){var c=null;"mousewheel"==b.type?c=-1*b.originalEvent.wheelDelta:"DOMMouseScroll"==b.type&&(c=40*b.originalEvent.detail),c&&(b.stopPropagation(),b.preventDefault(),a(this).scrollTop(c+a(this).scrollTop()))})}function i(){for(var a=0;a<l.length;a++){var b=l.eq(a),c="",d="",f=c="",g="",h="",i="",j="",k="";b.prop("selected")&&(d="selected sel"),b.is(":disabled")&&(d="disabled"),b.is(":selected:disabled")&&(d="selected sel disabled"),void 0!==b.attr("id")&&""!==b.attr("id")&&(f=' id="'+b.attr("id")+e.idSuffix+'"'),void 0!==b.attr("title")&&""!==l.attr("title")&&(g=' title="'+b.attr("title")+'"'),void 0!==b.attr("class")&&(i=" "+b.attr("class"),k=' data-jqfs-class="'+b.attr("class")+'"');var o,n=b.data();for(o in n)""!==n[o]&&(h+=" data-"+o+'="'+n[o]+'"');""!==d+i&&(c=' class="'+d+i+'"'),c="<li"+k+h+c+g+f+">"+b.html()+"</li>",b.parent().is("optgroup")&&(void 0!==b.parent().attr("class")&&(j=" "+b.parent().attr("class")),c="<li"+k+h+' class="'+d+i+" option"+j+'"'+g+f+">"+b.html()+"</li>",b.is(":first-child")&&(c='<li class="optgroup'+j+'">'+b.parent().attr("label")+"</li>"+c)),m+=c}}function j(){var g=new b,j="",k=d.data("placeholder"),n=d.data("search"),o=d.data("search-limit"),p=d.data("search-not-found"),q=d.data("search-placeholder"),r=d.data("z-index"),s=d.data("smart-positioning");void 0===k&&(k=e.selectPlaceholder),void 0!==n&&""!==n||(n=e.selectSearch),void 0!==o&&""!==o||(o=e.selectSearchLimit),void 0!==p&&""!==p||(p=e.selectSearchNotFound),void 0===q&&(q=e.selectSearchPlaceholder),void 0!==r&&""!==r||(r=e.singleSelectzIndex),void 0!==s&&""!==s||(s=e.selectSmartPositioning);var t=a("<div"+g.id+' class="jq-selectbox jqselect'+g.classes+'" style="display: inline-block; position: relative; z-index:'+r+'"><div class="jq-selectbox__select"'+g.title+' style="position: relative"><div class="jq-selectbox__select-text"></div><div class="jq-selectbox__trigger"><div class="jq-selectbox__trigger-arrow"></div></div></div></div>');d.css({margin:0,padding:0}).after(t).prependTo(t);var u=a("div.jq-selectbox__select",t),v=a("div.jq-selectbox__select-text",t),g=l.filter(":selected");i(),n&&(j='<div class="jq-selectbox__search"><input type="search" autocomplete="off" placeholder="'+q+'"></div><div class="jq-selectbox__not-found">'+p+"</div>");var w=a('<div class="jq-selectbox__dropdown" style="position: absolute">'+j+'<ul class="jq-scroll">'+m+"</ul></div>");t.append(w);var x=a("ul",w),y=a("li",w),z=a("input",w),A=a("div.jq-selectbox__not-found",w).hide();y.length<o&&z.parent().hide(),""===d.val()?v.text(k).addClass("placeholder"):v.text(g.text());var B=0,C=0;y.each(function(){var b=a(this);b.css({display:"inline-block"}),b.innerWidth()>B&&(B=b.innerWidth(),C=b.width()),b.css({display:""})}),v.is(".placeholder")&&v.width()>B?v.width(v.width()):(j=t.clone().appendTo("body").width("auto"),n=j.outerWidth(),j.remove(),n==t.outerWidth()&&v.width(C)),B>t.width()&&w.width(B),""===l.first().text()&&""!==d.data("placeholder")&&y.first().hide(),d.css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0});var D=t.outerHeight(),E=z.outerHeight(),F=x.css("max-height"),j=y.filter(".selected");1>j.length&&y.first().addClass("selected sel"),void 0===y.data("li-height")&&y.data("li-height",y.outerHeight());var G=w.css("top");return"auto"==w.css("left")&&w.css({left:0}),"auto"==w.css("top")&&w.css({top:D}),w.hide(),j.length&&(l.first().text()!=g.text()&&t.addClass("changed"),t.data("jqfs-class",j.data("jqfs-class")),t.addClass(j.data("jqfs-class"))),d.is(":disabled")?(t.addClass("disabled"),!1):(u.click(function(){if(a("div.jq-selectbox").filter(".opened").length&&e.onSelectClosed.call(a("div.jq-selectbox").filter(".opened")),d.focus(),!f){var b=a(window),c=y.data("li-height"),g=t.offset().top,i=b.height()-D-(g-b.scrollTop()),j=d.data("visible-options");void 0!==j&&""!==j||(j=e.selectVisibleOptions);var k=5*c,m=c*j;0<j&&6>j&&(k=m),0===j&&(m="auto");var j=function(){w.height("auto").css({bottom:"auto",top:G});var a=function(){x.css("max-height",Math.floor((i-20-E)/c)*c)};a(),x.css("max-height",m),"none"!=F&&x.css("max-height",F),i<w.outerHeight()+20&&a()},n=function(){w.height("auto").css({top:"auto",bottom:G});var a=function(){x.css("max-height",Math.floor((g-b.scrollTop()-20-E)/c)*c)};a(),x.css("max-height",m),"none"!=F&&x.css("max-height",F),g-b.scrollTop()-20<w.outerHeight()+20&&a()};!0===s||1===s?i>k+E+20?(j(),t.removeClass("dropup").addClass("dropdown")):(n(),t.removeClass("dropdown").addClass("dropup")):(!1===s||0===s)&&i>k+E+20&&(j(),t.removeClass("dropup").addClass("dropdown")),t.offset().left+w.outerWidth()>b.width()&&w.css({left:"auto",right:0}),a("div.jqselect").css({zIndex:r-1}).removeClass("opened"),t.css({zIndex:r}),w.is(":hidden")?(a("div.jq-selectbox__dropdown:visible").hide(),w.show(),t.addClass("opened focused"),e.onSelectOpened.call(t)):(w.hide(),t.removeClass("opened dropup dropdown"),a("div.jq-selectbox").filter(".opened").length&&e.onSelectClosed.call(t)),z.length&&(z.val("").keyup(),A.hide(),z.keyup(function(){var b=a(this).val();y.each(function(){a(this).html().match(RegExp(".*?"+b+".*?","i"))?a(this).show():a(this).hide()}),""===l.first().text()&&""!==d.data("placeholder")&&y.first().hide(),1>y.filter(":visible").length?A.show():A.hide()})),y.filter(".selected").length&&(""===d.val()?x.scrollTop(0):(0!==x.innerHeight()/c%2&&(c/=2),x.scrollTop(x.scrollTop()+y.filter(".selected").position().top-x.innerHeight()/2+c))),h(x)}}),y.hover(function(){a(this).siblings().removeClass("selected")}),y.filter(".selected").text(),y.filter(":not(.disabled):not(.optgroup)").click(function(){d.focus();var b=a(this),c=b.text();if(!b.is(".selected")){var f=b.index(),f=f-b.prevAll(".optgroup").length;b.addClass("selected sel").siblings().removeClass("selected sel"),l.prop("selected",!1).eq(f).prop("selected",!0),v.text(c),t.data("jqfs-class")&&t.removeClass(t.data("jqfs-class")),t.data("jqfs-class",b.data("jqfs-class")),t.addClass(b.data("jqfs-class")),d.change()}w.hide(),t.removeClass("opened dropup dropdown"),e.onSelectClosed.call(t)}),w.mouseout(function(){a("li.sel",w).addClass("selected")}),d.on("change.styler",function(){v.text(l.filter(":selected").text()).removeClass("placeholder"),y.removeClass("selected sel").not(".optgroup").eq(d[0].selectedIndex).addClass("selected sel"),l.first().text()!=y.filter(".selected").text()?t.addClass("changed"):t.removeClass("changed")}).on("focus.styler",function(){t.addClass("focused"),a("div.jqselect").not(".focused").removeClass("opened dropup dropdown").find("div.jq-selectbox__dropdown").hide()}).on("blur.styler",function(){t.removeClass("focused")}).on("keydown.styler keyup.styler",function(a){var b=y.data("li-height");""===d.val()?v.text(k).addClass("placeholder"):v.text(l.filter(":selected").text()),y.removeClass("selected sel").not(".optgroup").eq(d[0].selectedIndex).addClass("selected sel"),38!=a.which&&37!=a.which&&33!=a.which&&36!=a.which||(""===d.val()?x.scrollTop(0):x.scrollTop(x.scrollTop()+y.filter(".selected").position().top)),40!=a.which&&39!=a.which&&34!=a.which&&35!=a.which||x.scrollTop(x.scrollTop()+y.filter(".selected").position().top-x.innerHeight()+b),13==a.which&&(a.preventDefault(),w.hide(),t.removeClass("opened dropup dropdown"),e.onSelectClosed.call(t))}).on("keydown.styler",function(a){32==a.which&&(a.preventDefault(),u.click())}),void(c.registered||(a(document).on("click",c),c.registered=!0)))}function k(){var c=new b,e=a("<div"+c.id+' class="jq-select-multiple jqselect'+c.classes+'"'+c.title+' style="display: inline-block; position: relative"></div>');d.css({margin:0,padding:0}).after(e),i(),e.append("<ul>"+m+"</ul>");var f=a("ul",e).css({position:"relative","overflow-x":"hidden","-webkit-overflow-scrolling":"touch"}),g=a("li",e).attr("unselectable","on"),c=d.attr("size"),j=f.outerHeight(),k=g.outerHeight();void 0!==c&&0<c?f.css({height:k*c}):f.css({height:4*k}),j>e.height()&&(f.css("overflowY","scroll"),h(f),g.filter(".selected").length&&f.scrollTop(f.scrollTop()+g.filter(".selected").position().top)),d.prependTo(e).css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0}),d.is(":disabled")?(e.addClass("disabled"),l.each(function(){a(this).is(":selected")&&g.eq(a(this).index()).addClass("selected")})):(g.filter(":not(.disabled):not(.optgroup)").click(function(b){d.focus();var c=a(this);if(b.ctrlKey||b.metaKey||c.addClass("selected"),b.shiftKey||c.addClass("first"),b.ctrlKey||b.metaKey||b.shiftKey||c.siblings().removeClass("selected first"),(b.ctrlKey||b.metaKey)&&(c.is(".selected")?c.removeClass("selected first"):c.addClass("selected first"),c.siblings().removeClass("first")),b.shiftKey){var e=!1,f=!1;c.siblings().removeClass("selected").siblings(".first").addClass("selected"),c.prevAll().each(function(){a(this).is(".first")&&(e=!0)}),c.nextAll().each(function(){a(this).is(".first")&&(f=!0)}),e&&c.prevAll().each(function(){return!a(this).is(".selected")&&void a(this).not(".disabled, .optgroup").addClass("selected")}),f&&c.nextAll().each(function(){return!a(this).is(".selected")&&void a(this).not(".disabled, .optgroup").addClass("selected")}),1==g.filter(".selected").length&&c.addClass("first")}l.prop("selected",!1),g.filter(".selected").each(function(){var b=a(this),c=b.index();b.is(".option")&&(c-=b.prevAll(".optgroup").length),l.eq(c).prop("selected",!0)}),d.change()}),l.each(function(b){a(this).data("optionIndex",b)}),d.on("change.styler",function(){g.removeClass("selected");var b=[];l.filter(":selected").each(function(){b.push(a(this).data("optionIndex"))}),g.not(".optgroup").filter(function(c){return-1<a.inArray(c,b)}).addClass("selected")}).on("focus.styler",function(){e.addClass("focused")}).on("blur.styler",function(){e.removeClass("focused")}),j>e.height()&&d.on("keydown.styler",function(a){38!=a.which&&37!=a.which&&33!=a.which||f.scrollTop(f.scrollTop()+g.filter(".selected").position().top-k),40!=a.which&&39!=a.which&&34!=a.which||f.scrollTop(f.scrollTop()+g.filter(".selected:last").position().top-f.innerHeight()+2*k)}))}var l=a("option",d),m="";d.is("[multiple]")?g||f||k():j()};l(),d.on("refresh",function(){d.off(".styler").parent().before(d).remove(),l()})}else d.is(":reset")&&d.on("click",function(){setTimeout(function(){d.closest(e.wrapper).find("input, select").trigger("refresh")},1)})},destroy:function(){var b=a(this.element);b.is(":checkbox")||b.is(":radio")?(b.removeData("_"+d).off(".styler refresh").removeAttr("style").parent().before(b).remove(),b.closest("label").add('label[for="'+b.attr("id")+'"]').off(".styler")):b.is('input[type="number"]')?b.removeData("_"+d).off(".styler refresh").closest(".jq-number").before(b).remove():(b.is(":file")||b.is("select"))&&b.removeData("_"+d).off(".styler refresh").removeAttr("style").parent().before(b).remove()}},a.fn[d]=function(c){var e=arguments;if(void 0===c||"object"==typeof c)return this.each(function(){a.data(this,"_"+d)||a.data(this,"_"+d,new b(this,c))}).promise().done(function(){var b=a(this[0]).data("_"+d);b&&b.options.onFormStyled.call()}),this;if("string"==typeof c&&"_"!==c[0]&&"init"!==c){var f;return this.each(function(){var g=a.data(this,"_"+d);g instanceof b&&"function"==typeof g[c]&&(f=g[c].apply(g,Array.prototype.slice.call(e,1)))}),void 0!==f?f:this}},c.registered=!1});